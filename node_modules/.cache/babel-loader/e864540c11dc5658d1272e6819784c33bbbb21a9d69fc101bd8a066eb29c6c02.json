{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate,useParams}from'react-router-dom';import axios from'axios';import Swal from\"sweetalert2\";import{jsx as _jsx}from\"react/jsx-runtime\";function ProductItem(_ref){let{product}=_ref;const[loading,setLoading]=useState(false);const{id,email}=useParams();const navigate=useNavigate();// Initialize useNavigate for redirection\nuseEffect(()=>{if(!id){console.error('Product ID is missing:',{id});return;}console.log({email,id});const addToCart=async()=>{console.log('Adding to cart...');// Retrieve the token from localStorage (or wherever you are storing it)\nconst token=localStorage.getItem('token');if(!token){// If the token is not available, notify the user that they need to be logged in\nSwal.fire({title:\"Error\",text:\"You need to be logged in to add items to your cart.\",icon:\"error\"});return;}try{const response=await axios.post(`https://ram.freelogomaker.in/api/cart/${id}`,{email,quantity:1},{headers:{'Authorization':`Bearer ${token}`,// Send token in headers\n'Content-Type':'application/json'// Ensure proper content type\n}});console.log('Response:',response);if(response.data.success){setLoading(true);Swal.fire({title:\"Success\",text:response.data.message||\"Item added to cart successfully!\",icon:\"success\"});// Redirect to the shop after adding to the cart\nnavigate('/shop');}else{Swal.fire({title:\"Error\",text:response.data.message||\"Something went wrong.\",icon:\"error\"});}}catch(error){Swal.fire({title:\"Error\",text:error.message||\"Failed to add item to cart.\",icon:\"error\"});}};addToCart();},[id,email,navigate]);// Add navigate to the dependency array\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"product-item\",children:loading&&/*#__PURE__*/// You can show a loading spinner or something here if needed\n_jsx(\"div\",{children:\"Loading...\"})});}export default ProductItem;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useParams","axios","Swal","jsx","_jsx","ProductItem","_ref","product","loading","setLoading","id","email","navigate","console","error","log","addToCart","token","localStorage","getItem","fire","title","text","icon","response","post","quantity","headers","data","success","message","className","children"],"sources":["C:/Users/DECENT/Desktop/react/React_shoping_cart/src/Shoping_cart/Product/AddToCart.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport Swal from \"sweetalert2\";\r\n\r\nfunction ProductItem({ product }) {\r\n    const [loading, setLoading] = useState(false);\r\n    const { id, email } = useParams();\r\n    const navigate = useNavigate(); // Initialize useNavigate for redirection\r\n\r\n    useEffect(() => {\r\n        if (!id) {\r\n            console.error('Product ID is missing:', { id });\r\n            return;\r\n        }\r\n        console.log({ email, id });\r\n\r\n        const addToCart = async () => {\r\n            console.log('Adding to cart...');\r\n    \r\n            // Retrieve the token from localStorage (or wherever you are storing it)\r\n            const token = localStorage.getItem('token');\r\n    \r\n            if (!token) {\r\n                // If the token is not available, notify the user that they need to be logged in\r\n                Swal.fire({\r\n                    title: \"Error\",\r\n                    text: \"You need to be logged in to add items to your cart.\",\r\n                    icon: \"error\",\r\n                });\r\n                return;\r\n            }\r\n\r\n            try {\r\n                const response = await axios.post(\r\n                    `https://ram.freelogomaker.in/api/cart/${id}`,\r\n                    { email, quantity: 1 },\r\n                    {\r\n                        headers: {\r\n                            'Authorization': `Bearer ${token}`, // Send token in headers\r\n                            'Content-Type': 'application/json', // Ensure proper content type\r\n                        },\r\n                    }\r\n                );\r\n                console.log('Response:', response);\r\n\r\n                if (response.data.success) {\r\n                    setLoading(true);\r\n                    Swal.fire({\r\n                        title: \"Success\",\r\n                        text: response.data.message || \"Item added to cart successfully!\",\r\n                        icon: \"success\",\r\n                    });\r\n\r\n                    // Redirect to the shop after adding to the cart\r\n                    navigate('/shop');\r\n                } else {\r\n                    Swal.fire({\r\n                        title: \"Error\",\r\n                        text: response.data.message || \"Something went wrong.\",\r\n                        icon: \"error\",\r\n                    });\r\n                }\r\n            } catch (error) {\r\n                Swal.fire({\r\n                    title: \"Error\",\r\n                    text: error.message || \"Failed to add item to cart.\",\r\n                    icon: \"error\",\r\n                });\r\n            }\r\n        };\r\n\r\n        addToCart();\r\n    }, [id, email, navigate]); // Add navigate to the dependency array\r\n\r\n    return (\r\n        <div className=\"product-item\">\r\n            {loading && (\r\n                // You can show a loading spinner or something here if needed\r\n                <div>Loading...</div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ProductItem;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACzD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,IAAI,KAAM,aAAa,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE/B,QAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAc,IAAb,CAAEC,OAAQ,CAAC,CAAAD,IAAA,CAC5B,KAAM,CAACE,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAEa,EAAE,CAAEC,KAAM,CAAC,CAAGX,SAAS,CAAC,CAAC,CACjC,KAAM,CAAAY,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAAE;AAEhCD,SAAS,CAAC,IAAM,CACZ,GAAI,CAACY,EAAE,CAAE,CACLG,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAE,CAAEJ,EAAG,CAAC,CAAC,CAC/C,OACJ,CACAG,OAAO,CAACE,GAAG,CAAC,CAAEJ,KAAK,CAAED,EAAG,CAAC,CAAC,CAE1B,KAAM,CAAAM,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1BH,OAAO,CAACE,GAAG,CAAC,mBAAmB,CAAC,CAEhC;AACA,KAAM,CAAAE,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACR;AACAf,IAAI,CAACkB,IAAI,CAAC,CACNC,KAAK,CAAE,OAAO,CACdC,IAAI,CAAE,qDAAqD,CAC3DC,IAAI,CAAE,OACV,CAAC,CAAC,CACF,OACJ,CAEA,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAvB,KAAK,CAACwB,IAAI,CAC7B,yCAAyCf,EAAE,EAAE,CAC7C,CAAEC,KAAK,CAAEe,QAAQ,CAAE,CAAE,CAAC,CACtB,CACIC,OAAO,CAAE,CACL,eAAe,CAAE,UAAUV,KAAK,EAAE,CAAE;AACpC,cAAc,CAAE,kBAAoB;AACxC,CACJ,CACJ,CAAC,CACDJ,OAAO,CAACE,GAAG,CAAC,WAAW,CAAES,QAAQ,CAAC,CAElC,GAAIA,QAAQ,CAACI,IAAI,CAACC,OAAO,CAAE,CACvBpB,UAAU,CAAC,IAAI,CAAC,CAChBP,IAAI,CAACkB,IAAI,CAAC,CACNC,KAAK,CAAE,SAAS,CAChBC,IAAI,CAAEE,QAAQ,CAACI,IAAI,CAACE,OAAO,EAAI,kCAAkC,CACjEP,IAAI,CAAE,SACV,CAAC,CAAC,CAEF;AACAX,QAAQ,CAAC,OAAO,CAAC,CACrB,CAAC,IAAM,CACHV,IAAI,CAACkB,IAAI,CAAC,CACNC,KAAK,CAAE,OAAO,CACdC,IAAI,CAAEE,QAAQ,CAACI,IAAI,CAACE,OAAO,EAAI,uBAAuB,CACtDP,IAAI,CAAE,OACV,CAAC,CAAC,CACN,CACJ,CAAE,MAAOT,KAAK,CAAE,CACZZ,IAAI,CAACkB,IAAI,CAAC,CACNC,KAAK,CAAE,OAAO,CACdC,IAAI,CAAER,KAAK,CAACgB,OAAO,EAAI,6BAA6B,CACpDP,IAAI,CAAE,OACV,CAAC,CAAC,CACN,CACJ,CAAC,CAEDP,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,CAACN,EAAE,CAAEC,KAAK,CAAEC,QAAQ,CAAC,CAAC,CAAE;AAE3B,mBACIR,IAAA,QAAK2B,SAAS,CAAC,cAAc,CAAAC,QAAA,CACxBxB,OAAO,eACJ;AACAJ,IAAA,QAAA4B,QAAA,CAAK,YAAU,CAAK,CACvB,CACA,CAAC,CAEd,CAEA,cAAe,CAAA3B,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}